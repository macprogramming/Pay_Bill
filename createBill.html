<!doctype html>
<html lang="en">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link type="text/css" rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700,800,900" rel="stylesheet">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
        <link type="text/css" rel="stylesheet" href="css/style.css">
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-sanitize.js"></script>
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-route.js"></script>
        
        <title>Create Bill</title>
        <style type="text/css">            
            i span{
                width: 13px;
                height: 13px;
                font-size: 10px!important;
                /* margin: 0px 0 0px 0px; */
                border-radius: 50%!important;
                line-height: 10px;
                padding: 1px 0 0 0px!important;
            }
            .card{
                margin-bottom: 20px;
            }
            .card-header{
                background: #ffffff;
            }
            .card-body input{
                border: none;
                border-bottom: 1px solid gainsboro;
            }
            h2 img{
                width: 60px;
                height: 60px;
                border-radius: 100%;
            }
        </style>
    </head>
    <body ng-app="myApp">
        <div class="wrapper d-flex align-items-stretch">
            <nav id="sidebar">
                <div class="p-4 pt-5">
                    <a href="#" class="img logo rounded-circle mb-5" style="background-image: url(img/shopLogo.jpg);"></a>
                    <ul class="list-unstyled components mb-5">
                        <!--<li class="active">
                            <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><i class="fa fa-home"></i>&nbsp;Home</a>
                            <ul class="collapse list-unstyled" id="homeSubmenu">
                                <li>
                                    <a href="#">Home 1</a>
                                </li>
                                <li>
                                    <a href="#">Home 2</a>
                                </li>
                                <li>
                                    <a href="#">Home 3</a>
                                </li>
                            </ul>
                        </li>-->                        
                        <li class="active">
                            <a href="home.html"><i class="fa fa-list-alt"></i>&nbsp;Create Bill</a>
                        </li>
                        <li>
                            <a href="profile.html"><i class="fa fa-user-o"></i>&nbsp;My Profile</a>
                        </li>
                        <li>
                            <a href="history.html"><i class="fa fa-history"></i>&nbsp;History</a>
                        </li>
                        <!-- <li>
                            <a href="note.html"><i class="fa fa-shopping-cart"><span class="badge badge-primary">3</span></i>&nbsp;Note</a>
                        </li>
                        <li>
                            <a href="completedNote.html"><i class="fa fa-shopping-cart"></i>&nbsp;Completed Note</a>
                        </li>
                        <li>
                            <a href="profile.html"><i class="fa fa-user"></i>&nbsp;Profile</a>
                        </li> -->
                        <!-- <li>
                            <a href="#pageSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><i class="fa fa-file-o"></i>&nbsp;Pages</a>
                            <ul class="collapse list-unstyled" id="pageSubmenu">
                                <li>
                                    <a href="#">Page 1</a>
                                </li>
                                <li>
                                    <a href="#">Page 2</a>
                                </li>
                                <li>
                                    <a href="#">Page 3</a>
                                </li>
                            </ul>
                        </li> -->
                    </ul>
                    <div class="footer">
                        <!--<p>
                        Copyright Â©<script type="text/javascript">document.write(new Date().getFullYear());</script>2020 All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Sticky Note</a>
                        </p>-->                        
                        <ul class="list-unstyled">
                            <li>
                                <a href="#homeSubmenu"><i class="fa fa-power-off"></i>&nbsp;Logout</a>                                
                            </li>
                        </ul>
                        <a href="#">Bill Pay It</a>
                    </div>
                </div>
            </nav>

            <div id="content" ng-controller="myController" style="margin: 0 0 0px 50px;">
                <nav class="navbar navbar-expand-lg navbar-light bg-light">
                    <div class="container-fluid">
                        <button type="button" id="sidebarCollapse" class="btn btn-warning text-white">
                            <i class="fa fa-bars"></i>
                            <span class="sr-only">Toggle Menu</span>
                        </button>
                        <h3 class="text-primary">Bill Pay App</h3>
                        <h2 class="text-center"><img src="img/shopLogo.jpg" alt=""" class="img img-circle"></h2>
                                                                   
                    </div>
                </nav>
                <div class="container">
                    <div class="well well-light">
                        <div class="">
                            <form action="" name="customerForm" ng-hide="formCustomer">
                                <div class="form-row">
                                    <div class="col-md-4 my-1">                                        
                                        <input type="date" class="form-control" ng-model="date" name="" id="" placeholder="Date">
                                        <p class="error" ng-show="!date" ng-bind="errDate"></p>
                                    </div>
                                    <div class="col-md-6 my-1">
                                        <input type="text" class="form-control" ng-model="customerName" name="" id="" placeholder="Customer Name">
                                        <p class="error" ng-show="!customerName" ng-bind="errCostomerName"></p>
                                    </div>
                                    <div class="col-auto my-1">
                                        <button type="button" class="btn btn-block btn-primary" ng-click="btnAddCutomer()"><i class="fa fa-plus"></i>&nbsp;Add</button>
                                    </div>
                                </div>                                
                            </form>
                            <form name="formAddItem" ng-show="formItems">
                                <div class="form-row align-items-center">
                                    <div class="col-sm-6 my-1">
                                        <label class="sr-only" for="inlineFormInputName">Item</label>
                                        <input type="text" class="form-control" ng-model="itemName" id="inlineFormInputName" placeholder="Item Name">
                                    </div>
                                    <div class="col-sm-2 my-1">
                                        <label class="sr-only" for="inlineFormInputName">Price</label>
                                        <input type="number" class="form-control" ng-model="price" id="inlineFormInputName" placeholder="Price">
                                    </div>
                                    <div class="col-sm-2 my-1">
                                        <label class="sr-only" for="inlineFormInputName">Quantity</label>
                                        <input type="number" class="form-control" ng-model="quantity" id="inlineFormInputName" placeholder="Quantity">
                                    </div>                                                                      
                                    <div class="col-auto my-1">
                                        <button type="submit" class="btn btn-primary" ng-click="addNewItem(itemName,quantity,price)">Submit</button>
                                    </div>
                                </div>
                                <div class="error" ng-bind="errMessage" id="something"></div>
                            </form>
                        </div><hr>
                        
                        <div class="row">
                            <section class="col-xs-12 col-sm-12 col-md-12 col-lg-12" ng-show="itemTable">
                                <h6>Total Items : <span class="badge badge-primary">{{totalItems}}</span></h6>
                                <table class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th width="5%">Sr.No</th>
                                            <th>Item Name</th>
                                            <th width="10%">Quantity</th>
                                            <th width="10%">Price</th>
                                            <th width="20%">Total</th>
                                        </tr>                                        
                                    </thead>
                                    <tbody>                                        
                                        <tr ng-repeat="item in items">
                                            <td>{{$index+1}}</td>
                                            <td>{{item.itemName}}</td>
                                            <td>{{item.quantity}}</td>
                                            <td>{{item.price}}&nbsp;&#x20B9</td>
                                            <td>{{item.total}}&nbsp;&#x20B9</td>
                                        </tr>
                                        <tr>
                                            <td colspan="4" class="text-right">Total</td>
                                            <td>{{ totalPay() }}&nbsp;&#x20B9</td>
                                        </tr>                                        
                                    </tbody>
                                </table>
                                <div>
                                    <table class="table">
                                        <tr class="pull-right">
                                            <td>
                                                <button type="button" class="btn btn-sm btn-primary" ng-click="createBillRecipt()">Create Bill Recipt</button>
                                                <!-- <button type="button" class="btn btn-sm btn-primary">Print Recipt</button> -->
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </section>
                        </div>
                        <div class="" ng-show="printReceipt">
                            <div class="card">
                                <div class="card-header">
                                    <div class="row">
                                        <section class="col-xs-4 col-sm-4 col-md-4 col-lg-4">
                                            <img src="img/shopLogo.jpg" alt="" width="100px">
                                        </section>
                                        <section class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                                            <h3 class="text-primary">Om Sai Shop</h3>
                                            <p>Address : <span class="text-warning">Ulhasnagar-1, Kalyan , Thane, Maharashtra</span> </p>
                                            <p>Time : <span class="text-warning">10:00 AM to 08:00 PM</span> </p>
                                        </section>
                                    </div>
                                </div>
                                <div class="card-body" id="printSectionId">
                                    <div class="printReceipt1">
                                        <div>                                        
                                            <!-- <input type="text" class="form-control" ng-bind="date" name="" id="">-->
                                            Date : <span>{{date}}</span>
                                        </div>
                                        <div>
                                            <!-- <input type="text" class="form-control" ng-bind="customerName" name="" id="">-->
                                            Customer Name : <span>{{customerName}}</span>
                                        </div>                                        
                                    </div><br>
                                    <table class="table table-bordered printReceipt1">
                                        <thead>
                                            <tr>
                                                <th width="5%">Sr.No</th>
                                                <th>Item Name</th>
                                                <th width="20%">Quantity</th>
                                                <th width="20%">Price</th>
                                            </tr>                                        
                                        </thead>
                                        <tbody>                                            
                                            <tr ng-repeat="item in items">
                                                <td>{{$index+1}}</td>
                                                <td>{{item.itemName}}</td>
                                                <td>{{item.quantity}}</td>
                                                <td>{{item.price}}</td>
                                            </tr>
                                            <tr>
                                                <td colspan="3" class="text-right">Total</td>
                                                <td>{{ totalPay() }}&nbsp;&#x20B9</td>
                                            </tr>                                            
                                        </tbody>
                                    </table>
                                    <div>
                                        <table class="table">
                                            <tr class="pull-right">
                                                <td>
                                                    <button type="button" class="btn btn-sm btn-primary" onclick="printIt(document.getElementById('printSectionId').innerHTML); return false">Print Recipt</button>
                                                    <!-- <button type="button" class="btn btn-sm btn-primary">Print Recipt</button> -->
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>                
            </div>
        </div>
        <script type="text/javascript" src="bootstrap_js/bootstrap_proper.min.js"></script>
        <script type="text/javascript" src="bootstrap_js/bootstrap_5.min.js"></script>
        <script type="text/javascript" src="jquery/jquery.3.5.1.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function(){
                $('#sidebarCollapse').on('click',function(){
                     $('#sidebar').toggleClass('active');
                });                
            });
        </script>
        <script>            
            var ItemData = [];
            let shopData = localStorage.getItem("shopData");
            var myApp = angular.module('myApp', []);
            
            myApp.controller('myController', function($scope, $http) {
                $scope.shopData = shopData;
                $scope.btnAddCutomer = function(){
                    if($scope.date == null){
                        $scope.errDate = "Please enter date"
                    }else if($scope.customerName == null){
                        $scope.errCostomerName = "Please enter customer name"
                    }else{
                        $scope.formItems = true;
                    }                    
                }

                $scope.items = ItemData;
                $scope.addNewItem = function(txtItemName,txtQuantity,txtPrice){                    
                    if($scope.itemName == null || $scope.quantity == null || $scope.price == null){
                        $scope.errMessage = 'Please enter item , price & quantity';
                    }else{
                        $scope.itemTable = true;
                        $scope.totalItems = $scope.items.length + 1;
                        let index = $scope.items.lenth + 1;
                        $scope.items.push({
                            id:index,
                            itemName:txtItemName,
                            quantity:txtQuantity,
                            price:txtPrice,
                            total:txtQuantity * txtPrice,
                        });
                        $scope.itemName = "";
                        $scope.quantity = "";
                        $scope.price = "";
                    }
                }
                $scope.totalPay = function(){
                    let total = 0;
                    for(let i=0; i< $scope.items.length;i++){
                        let item = $scope.items[i];
                        total += (item.price * item.quantity)
                    }
                    return total;
                }

                $scope.customerData = [];
                localStorage.getItem('customerReciept', JSON.stringify($scope.customerData));
                
                $scope.createBillRecipt = function(){
                    $scope.printReceipt = true;
                    $scope.customerData.push({
                        date:$scope.date,
                        cstName:$scope.customerName,
                        cstName:$scope.customerName,
                        cstTotalBill:$scope.totalPay()
                    });
                    //localStorage.getItem('customerReciept', JSON.stringify($scope.customerData));
                    localStorage.setItem('customerReciept', JSON.stringify($scope.customerData));
                    //console.log($scope.customerData);
                }                
            });

            function printIt(printThis){				 
                win = window.open();
                self.focus();
                win.document.open();
                win.document.write('<'+'html'+'><'+'head'+'><'+'style'+'>');
                win.document.write('i span{width: 13px;height: 13px;font-size: 10px!important;border-radius: 50%!important;line-height: 10px;padding: 1px 0 0 0px!important;}','.card{margin-bottom: 20px;}','.card-header{background: #ffffff;}','.card-body input{border: none;border-bottom: 1px solid gainsboro;}','h2 img{width: 60px;height: 60px;border-radius: 100%;}');
                win.document.write('<'+'/'+'style'+'><'+'/'+'head'+'><'+'body'+'>');
                win.document.write(printThis);
                win.document.write('<'+'/'+'body'+'><'+'/'+'html'+'>');
                win.document.close();
                win.print();
                win.close();
                //$(".btnContainFile").html("File Attached");
            }
        </script>
  </body>
</html>